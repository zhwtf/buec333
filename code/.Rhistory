cbind(colMeans(small_df[,vars]),
colMeans(large_df[,vars]))
plot <- ggplot(data=school_df,aes(x=class_size,y=testscr)) +
geom_point()
plot
plot <- ggplot(data=school_df,aes(x=class_size,y=testscr)) +
geom_point() +
geom_smooth(method="lm",se=FALSE)
plot
ggsave("nice_plot.pdf",width=10,height=10)
?lm
ols_classsize <- lm(testscr ~ class_size,data=school_df)
summary(ols_classsize)
summary(ols_classsize)
mlr <- lm(testscr ~ class_size + avginc, data=school_df)
summary(mlr)
summary(mlr)
mlr2 <- lm(testscr ~ class_size + avginc + el_pct, data=school_df)
summary(mlr2)
summary(school_df)
rm(list=ls())
require(foreign)
require(ggplot2)
## Load the data. We are interested in the
wageData <- read.dta("WAGE1.DTA")
wageData$female <- as.factor(wageData$female)
summary(wageData)
mean(wageData$wage[wageData$female==1]) #select only the women
mean(wageData$wage[wageData$female==0]) #select only the men
Ybar_female <- mean(wageData$wage[wageData$female==1]) #select only the women
Ybar_male <- mean(wageData$wage[wageData$female==0]) #select only the men
wage_gap <- Ybar_female - Ybar_male
lm(wage~femake,data=wageData)
lm(wage~female,data=wageData)
wage_regression <- lm(wage~female,data=wageData)
summary(wage_regression)
wage
wage_gap
summary(lm(wage~educ,data=wageData,subset = (female==1)))
summary(lm(wage ~ female + educ + female*educ,data=wageData))
summary(lm(wage~educ,data=wageData,subset = (female==1)))
summary(lm(wage~educ,data=wageData,subset = (female==0)))
# This is equal to one regression with all the data
summary(lm(wage ~ female + educ + female*educ,data=wageData))
DX = wage_gap
s2female <- var(wageData$wage[wageData$female==1])
s2male <- var(wageData$wage[wageData$female==0])
nfemale <- sum(wageData$female)
nfemale <- sum(wageData$female==1)
nmale <- sum(wageData$female==0)
DX <-  wage_gap
s2female <- var(wageData$wage[wageData$female==1])
s2male <- var(wageData$wage[wageData$female==0])
nfemale <- sum(wageData$female==1)
nmale <- sum(wageData$female==0)
DX_SE <-  sqrt(s2female / nfemale + s2male / nmale)
tact <- DX / DX_SE
2*pnorm(-abs(tact))
summary(wage_regression)
DX_SE
educ_female <- mean(wageData$educ[wageData$female==1])
educ_male <- mean(wageData$educ[wageData$female==0])
educ_gap <- educ_female - educ_male
# Does this matter for the wage gap?
qplot(x=educ,y=lwage,col=female,data=wageData,xlab="Years of education",ylab="Log of hourly averages earnings")
summary(lm(wage~educ,data=wageData,subset = (female==1)))  #1
summary(lm(wage~educ,data=wageData,subset = (female==0)))  #2
summary(lm(wage ~ female + educ + female*educ,data=wageData)) #3
source('C:/Users/Chris Muris/Dropbox/buec333/labfiles/BasicExercises2.R', echo=TRUE)
data <- df(X=X,Y=Y)
source('~/.active-rstudio-document', echo=TRUE)
summary(lm(Y~X,data=data))
source('~/.active-rstudio-document', echo=TRUE)
summary(lm(Y~X,data=df_outlier))
source('~/.active-rstudio-document', echo=TRUE)
df_outlier <- data.framef(X,Y)
df_outlier <- data.frame(X,Y)
summary(lm(Y~X,data=df_outlier))
df$Y[1] <- df$Y[1] + 1
summary(lm(Y~X,data=df_outlier))
df_outlier$Y[1] <- df_outlier$Y[1] + 1
summary(lm(Y~X,data=df_outlier))
df_outlier$Y[1] <- df_outlier$Y[1] + 1000
summary(lm(Y~X,data=df_outlier))
df_outlier$Y[1] <- df_outlier$Y[1] + 10000
summary(lm(Y~X,data=df_outlier))
source('~/.active-rstudio-document', echo=TRUE)
beta0 <-  1
beta1 <-  2
n <- 100
X <- runif(n,0,1)
X
u <- rnorm(n,0,1)
u
Y <- beta0 + beta1*X + u
require(ggplot2)
qplot(X,Y)
df_outlier <- data.frame(X,Y)
df_outlier <- data.frame(X,Y)
summary(lm(Y~X,data=df_outlier))
df_outlier$Y
df_outlier$Y[1] <- df_outlier$Y[1] + 1
summary(lm(Y~X,data=df_outlier))
df$Y
df_outlier$Y
df_outlier$Y[1] <- df_outlier$Y[1] + 100
df_outlier$Y
summary(lm(Y~X,data=df_outlier))
rm(list=ls())
require(foreign)
require(ggplot2)
wageData <- read.dta("WAGE1.DTA")
wageData$female <- as.factor(wageData$female)
summary(wageData)
Ybar_female <- mean(wageData$wage[wageData$female==1]) #select only the women
Ybar_male <- mean(wageData$wage[wageData$female==0]) #select only the men
wage_gap <- Ybar_female - Ybar_male
wage_gap
wage_regression <- lm(wage~female,data=wageData)
summary(wage_regression)
DX <-  wage_gap
s2female <- var(wageData$wage[wageData$female==1])
s2male <- var(wageData$wage[wageData$female==0])
nfemale <- sum(wageData$female==1)
nmale <- sum(wageData$female==0)
DX_SE <-  sqrt(s2female / nfemale + s2male / nmale)
tact <- DX / DX_SE
2*pnorm(-abs(tact))
summary(wage_regression)
matrix(rnorm(6),nrow=3,ncol=2)
matrix(rnorm(3),nrow=3,ncol=2)
?T
T.T <- 20
S <- 3
total_draws <- T.T*S
shock_vector <- rnorm(total_draws)
shock_vector
T.T <- 20
S <- 4
total_draws <- T.T*S
shock_vector <- rnorm(total_draws)
shock_vector
T.T <- 3
S <- 2
total_draws <- T.T*S
shock_vector <- rnorm(total_draws)
shock_vector
matrix(shock_vector,nrow=T.T,ncol=S)
matrix(shock_vector,nrow=T.T,ncol=1)
matrix(shock_vector,nrow=T.T,ncol=4)
matrix(shock_vector,nrow=T.T,ncol=4)
matrix(shock_vector,nrow=T.T,ncol=3)
rm(list=ls())
require(foreign)
require(ggplot2)
## Load and inspect the data,
wageData <- read.dta("WAGE1.DTA")
wageData$female <- as.factor(wageData$female)
summary(wageData)
wageData <- read.dta("WAGE1.DTA")
str(wageData)
wageData
head(wageData,10)
wageData$wage
mean(wageData$wage)
source('C:/Users/Chris Muris/Dropbox/buec333/code/week5-binary.R', echo=TRUE)
mean(wageData$wage)
rm(list=ls())
require(foreign)
CPS_data <- read.dta("cps92_08.dta")
CPS_data
str(CPS_data)
mean(CPS_data$ahe)
?confint
se_Xbar <- sqrt(var(CPS_data$ahe) / nrow(CPS_data))
c(Xbar-1.96*se_Xbar,Xbar+1.96*se_Xbar)
Xbar <- mean(CPS_data$ahe)
# Get the SE
se_Xbar <- sqrt(var(CPS_data$ahe) / nrow(CPS_data))
# Confidence intervals
c(Xbar-1.96*se_Xbar,Xbar+1.96*se_Xbar)
CPS_data$ahe_2008 <- CPS_data$ahe / 140.3 * 215.2
cbind(CPS_data$ahe_2008,CPS_data$ahe)
CPS_data$ahe_2008 <- CPS_data$ahe / 140.3 * 215.2
Xbar <- mean(CPS_data$ahe_2008)
# Get the SE
se_Xbar <- sqrt(var(CPS_data$ahe_2008) / nrow(CPS_data))
# Confidence intervals
c(Xbar-1.96*se_Xbar,Xbar+1.96*se_Xbar)
x <- 5
x^2
x <- 7
x^2
####################################################
## WHy do some hockey players earn more than others?
####################################################
# We are going to use a regression model to explain
#
# SALARY (annual, in dollars)
#
# by
#
# ??
# Step 1: Load the data
hockeyData <- read.csv("NHL1998-99.csv",header=TRUE,na.strings="-999")
# Step 2: Exploratory data analysis:
# - What do the variables mean?
# - Anything funny going on?
# -
summary(hockeyData)
# Issue 1: Two Petr Sykora's!
# print all the names, then extract the info for them
hockeyData$PLAYER
# This identifies them as players 708 and 709
hockeyData[c(708,709),]
# Let's look at some data
require(ggplot2)
qplot(SALARY,data=hockeyData)
## Who is the big earner?
#Find the maximum salary
bigsalary <-  max(hockeyData$SALARY,na.rm=TRUE)
bigsalary
#Find the row in the data that has this player
index <- which(hockeyData$SALARY == bigsalary)
index
#Print player info
hockeyData[index,]
## And the small one?
smallsalary <-  min(hockeyData$SALARY,na.rm=TRUE)
index2 <- which(hockeyData$SALARY == smallsalary)
#Print player info
hockeyData[c(index,index2),]
# This makes me think that ... matters
# Issue 2: Missing data
summary(hockeyData)
# The data on 142 players is missing.
# Is this a problem?
# I select only the players for which we have data
hockeyData <- subset(hockeyData,!is.na(hockeyData$SALARY))
# Issue 3: The simplest model.
# points = goals + assists
# Say that you believe that this determines how valuable a player is
model1 <- lm(SALARY~Points,data=hockeyData)
summary(model1)
qplot(Points,SALARY,data=hockeyData)
qplot(Points,SALARY,data=hockeyData) + xlim(0,50)
####################################################
## WHy do some hockey players earn more than others?
####################################################
# We are going to use a regression model to explain
#
# SALARY (annual, in dollars)
#
# by
#
# ??
# Step 1: Load the data
hockeyData <- read.csv("NHL1998-99.csv",header=TRUE,na.strings="-999")
# Step 2: Exploratory data analysis:
# - What do the variables mean?
# - Anything funny going on?
# -
summary(hockeyData)
# Issue 1: Two Petr Sykora's!
# print all the names, then extract the info for them
hockeyData$PLAYER
# This identifies them as players 708 and 709
hockeyData[c(708,709),]
# Let's look at some data
require(ggplot2)
qplot(SALARY,data=hockeyData)
## Who is the big earner?
#Find the maximum salary
bigsalary <-  max(hockeyData$SALARY,na.rm=TRUE)
bigsalary
#Find the row in the data that has this player
index <- which(hockeyData$SALARY == bigsalary)
index
#Print player info
hockeyData[index,]
## And the small one?
smallsalary <-  min(hockeyData$SALARY,na.rm=TRUE)
index2 <- which(hockeyData$SALARY == smallsalary)
#Print player info
hockeyData[c(index,index2),]
# This makes me think that ... matters
# Issue 2: Missing data
summary(hockeyData)
# The data on 142 players is missing.
# Is this a problem?
# I select only the players for which we have data
hockeyData <- subset(hockeyData,!is.na(hockeyData$SALARY))
# Issue 3: The simplest model.
# points = goals + assists
# Say that you believe that this determines how valuable a player is
model1 <- lm(SALARY~Points,data=hockeyData)
summary(model1)
# Successful model! I want to refine it and include goals and assists as well
# so that I know where the value comes from: scoring or helping to score
model2 <- lm(SALARY~Points+Goals+Assists,data=hockeyData)
summary(model2)
# WHat is going on?
# Note R^2 did not really go up. Let's stick with "points" only.
# Do you think that we can improve on this model?
# I am worried about omitted variables. How about including a dummy for
# somebodies position?
model3 <- lm(SALARY~Points+Position,data=hockeyData)
summary(model3)
Ytilde <- residuals(lm(SALARY~Position,data=hockeyData))
X1tilde <- residuals(lm(Points~Position,data=hockeyData))
summary(lm(Ytilde~X1tilde))
qplot(AGE,SALARY,data=hockeyData)
qplot(AGE,SALARY,data=hockeyData) + geom_smooth()
qplot(Years_EXP,SALARY,data=hockeyData) + geom_smooth()
model1 <- lm(SALARY~Points,data=hockeyData)
summary(model1)
# Successful model! I want to refine it and include goals and assists as well
# so that I know where the value comes from: scoring or helping to score
model2 <- lm(SALARY~Points+Goals+Assists,data=hockeyData)
summary(model2)
library(stargazer)
install.packages("stargazer")
library(stargazer)
?stargazer
stargazer(model1,model3,
title="Results: OV bias",type="text")
stargazer(model1,model3,
title="Results: OV bias",type="text")
model4 <- lm(SALARY~Points+Position+AGE+Years_EXP,data=hockeyData)
summary(model4)
# What about some unlikely variables: LvR-handedness
model5 <- lm(SALARY~Points+Position+AGE+Years_EXP,data=hockeyData)
stargazer(model1,model3,model4,model5,
title="OV",type="text")
stargazer(model1,model3,model4,model5,
title="OV",type="text")
source('C:/Users/Chris Muris/Dropbox/buec333/code/week7-hockey.R', echo=TRUE)
stargazer(model1,model3,model4,model5,
title="OV",type="text")
stargazer(model1,model3,model4,model5,
title="OV",type="text")
?stargazer
stargazer(model1,model3,model4,model5,
title="OV",keep.stat = c("n"),type="text")
summary(hockeyData)
model5 <- lm(SALARY~Points+Position+AGE+Handed+Years_EXP,data=hockeyData)
stargazer(model1,model3,model4,model5,
title="OV",keep.stat = c("n"),type="text")
model5 <- lm(SALARY~Points+Position+AGE+Handed+Years_EXP,data=hockeyData)
stargazer(model1,model3,model4,model5,
title="OV",keep.stat = c("n"),type="text")
library(readr)
yield_df <- read_csv("yield.txt")
yield_df <- read_csv("yield.txt")
yield
yield_df
yield_df <- read_csv("yield.txt")
yield_df
qplot(Temperature,Yield,data=yield_df)
qplot(Temperature,Yield,data=yield_df) + geom_smooth()
qplot(Temperature,Yield,data=yield_df) + geom_smooth(,SE=FALSE)
qplot(Temperature,Yield,data=yield_df) + geom_smooth(SE=FALSE)
qplot(Temperature,Yield,data=yield_df) + geom_smooth(se=FALSE)
summary(lm(Yield~Temperature,data=yield_df))
source('C:/Users/Chris Muris/Dropbox/buec333/code/week7-hockey.R', echo=TRUE)
summary(lm(Yield~Temperature,data=yield_df))
qplot(Temperature,Yield,data=yield_df) +
geom_smooth(se=FALSE) +
geom_smooth(method="lm",se=FALSE)
?geom_smooth
qplot(Temperature,Yield,data=yield_df) +
geom_smooth(se=FALSE) +
geom_smooth(method="lm",se=FALSE,color="red")
geom_smooth(method="lm",se=FALSE,aes(color="red"))
qplot(Temperature,Yield,data=yield_df) +
geom_smooth(se=FALSE) +
geom_smooth(method="lm",se=FALSE,aes(color="red"))
library(readr)
yield_df <- read_csv("yield.txt")
# An experiment that examines the yield for a certain crop,
#  as a function of the (set) temperature of its environment.
qplot(Temperature,Yield,data=yield_df)
qplot(Temperature,Yield,data=yield_df) + geom_smooth(se=FALSE)
library(ggplot2)
qplot(Temperature,Yield,data=yield_df)
qplot(Temperature,Yield,data=yield_df) + geom_smooth(se=FALSE)
# Does this look linear?
# What happens when you use the following output
#   to decide whether to increase the temperature?
qplot(Temperature,Yield,data=yield_df) +
geom_smooth(se=FALSE) +
geom_smooth(method="lm",se=FALSE,aes(color="red"))
# You find that the effect is positive:
library(readr)
yield_df <- read_csv("yield.txt")
# Remember:
library(ggplot2)
qplot(Temperature,Yield,data=yield_df) + geom_smooth(se=FALSE)
# The plot suggests that the relationship
#   may be nonlinear.
# We fit a quadratic curve
yield_df$temp2 <- yield_df$Temperature * yield_df$Temperature
yield_quad <- lm(Yield~Temperature+temp2,data=yield_df)
summary(yield_quad)
?geom_smooth
qplot(Temperature,Yield,data=yield_df) +
geom_smooth(method="lm",formula=y~poly(x,2),se=FALSE)
yield_quad$coefficients
tempstar <- - b[2] / (2*b[3])
b <- yield_quad$coefficients
tempstar <- - b[2] / (2*b[3])
tempstar
source('C:/Users/Chris Muris/Dropbox/buec333/code/old/001-wages.R', echo=TRUE)
source('C:/Users/Chris Muris/Dropbox/buec333/code/old/001-wages.R', echo=TRUE)
summary(lm(IQ~brthord,data=wageData.2))
source('C:/Users/Chris Muris/Dropbox/buec333/code/week7-3-logs.R', echo=TRUE)
summary(lm(IQ~brthord,data=wageData.2))
summary(lm(sibs~feduc+meduc,data=wageData.2))
summary(lm(IQ~brthord+feduc+meduc,data=wageData.2))
stargazer(iq_order,iq_order_ov,type="text",keep.stat = c("n"))
source('C:/Users/Chris Muris/Dropbox/buec333/code/week7-3-logs.R', echo=TRUE)
model2 <- lm(lwage~educ+female,data=wageData)
summary(model2)
stargazer(model1,model2,model3,type="text",keep_stats=c("n"))
stargazer(model1,model2,model3,type="text",keep_stats=c("n"))
stargazer(iq_order,iq_order_ov,type="text",keep.stat = c("n"))
stargazer(model1,model2,model3,type="text",keep.stats=c("n"))
stargazer(model1,model2,model3,type="text",keep.stats=c("n"))
stargazer(model1,model2,model3,type="text",keep.stats=c("n"))
type=
q
stargazer(model1,model2,model3,type="text",keep.stat=c("n"))
stargazer(model1,model2,keep.stat=c("n"),type="text")
model1 <- lm(lwage~educ,data=wageData.2)
summary(model1)
# We have argued that there is an omitted variable bias
# in this relationship: "ability" may be driven by both.
# This data set measures IQ, which could be a proxy.
# Q: An explanation for why it is much lower?
model2 <- lm(lwage~educ+IQ,data=wageData.2)
summary(model2)
stargazer(model1,model2,keep.stat=c("n"),type="text")
hockeyData <- read.csv("NHL1998-99.csv",header=TRUE,na.strings="-999")
summary(hockeyData)
summary(hockeyData)
head(hockeyData,10)
summary(hockeyData)
hockeyData$PLAYER
hockeyData$PLAYER
hockeyData[c(708,709),]
require(ggplot2)
qplot(SALARY,data=hockeyData)
bigsalary <-  max(hockeyData$SALARY,na.rm=TRUE)
bigsalary
index <- which(hockeyData$SALARY == bigsalary)
index
#Print player info
hockeyData[index,]
smallsalary <-  min(hockeyData$SALARY,na.rm=TRUE)
index2 <- which(hockeyData$SALARY == smallsalary)
#Print player info
hockeyData[c(index,index2),]
hockeyData[c(index,index2),]
summary(hockeyData)
hockeyData <- subset(hockeyData,!is.na(hockeyData$SALARY))
hockeyData$SALARY <- hockeyData$SALARY/1000
model1 <- lm(SALARY~Points,data=hockeyData)
summary(model1)
summary(model1)
model2 <- lm(SALARY~Points+Goals+Assists,data=hockeyData)
summary(model2)
summary(lm(Points~Goals+Assists,data=hockeyData))
model2 <- lm(SALARY~Goals+Assists,data=hockeyData)
summary(model2)
summary(hockeyData$Position)
model3 <- lm(SALARY~Points+Position,data=hockeyData)
summary(model3)
lm(SALARY~Points,data=hockeyData)
model3 <- lm(SALARY~Goals+Assists+Position,data=hockeyData)
summary(model3)
model3 <- lm(SALARY~Points+Position,data=hockeyData)
summary(model3)
# Show the regression output side-by-side
library(stargazer)
stargazer(model1,model3,
title="Results: OV bias",type="text")
Ytilde <- residuals(lm(SALARY~Position,data=hockeyData))
X1tilde <- residuals(lm(Points~Position,data=hockeyData))
summary(lm(Ytilde~X1tilde))
summary(lm(Ytilde~X1tilde))
lm(SALARY~Points+Position,data=hockeyData)
lm(Ytilde~X1tilde)
model4 <- lm(SALARY~Points+Position+AGE+Years_EXP,data=hockeyData)
summary(model4)
# What about some unlikely variables: LvR-handedness
model5 <- lm(SALARY~Points+Position+AGE+Years_EXP+Handed,data=hockeyData)
stargazer(model1,model3,model4,model5,
title="OV",keep.stat = c("n"),type="text")
G
G
model <- lm(SALARY~Goals+Assists+Position+Handed+AGE,data=hockeyData)
model <- lm(SALARY~Goals+Assists+Position+Handed+AGE,data=hockeyData)
summary(model)
-97.512/80.537
library(readr)
yield_df <- read_csv("yield.txt")
qplot(Temperature,Yield,data=yield_df)
qplot(Temperature,Yield,data=yield_df) + geom_smooth(se=FALSE)
qplot(Temperature,Yield,data=yield_df) +
geom_smooth(se=FALSE) +
geom_smooth(method="lm",se=FALSE,aes(color="red"))
summary(lm(Yield~Temperature,data=yield_df))
